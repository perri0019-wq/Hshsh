<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>BOOM</title>

<style>
*{
  box-sizing:border-box;
  font-family:Arial,sans-serif;
  font-weight:bold;
}
body{
  margin:0;
  background:#f4f6ff;
  font-size:22px;
}

/* ===== HEADER ===== */
.header{
  display:flex;
  align-items:center;
  padding:20px;
  background:#fff;
  gap:20px;
}
.avatar{
  width:80px;
  height:80px;
  border-radius:50%;
  background:#ddd;
}
.menu-back{
  display:none;
  background:#eef1ff;
  padding:30px 46px;
  border-radius:30px;
  font-size:32px;
  cursor:pointer;
}
.balance{
  margin-left:auto;
  display:flex;
  align-items:center;
  background:#eef1ff;
  padding:30px 44px;
  border-radius:36px;
  font-size:38px;
  transition:.3s;
}
.balance.win{transform:scale(1.08)}
.coin-icon{
  width:48px;
  height:48px;
  margin-right:14px;
}

/* ===== MENU ===== */
.menu{padding:28px}
.bomb-btn{
  width:100%;
  height:25vh;
  position:relative;
  border:5px solid #4c6fff;
  border-radius:36px;
  overflow:hidden;
  cursor:pointer;
  background:#000;
  box-shadow:
    0 0 20px rgba(76,111,255,.5),
    0 0 40px rgba(76,111,255,.35);
  animation:boomGlow 2s infinite alternate;
}
.bomb-btn:active{transform:scale(.96)}
.bomb-btn img{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
}
.bomb-btn span{
  position:relative;
  z-index:2;
  font-size:96px;
  color:#fff;
  text-shadow:0 4px 12px rgba(0,0,0,.7);
}

/* ===== GAME ===== */
.game{display:none;padding:26px}
.win-info{
  text-align:center;
  font-size:48px;
  margin-bottom:26px;
}
.grid{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:14px;
}
.cell{
  aspect-ratio:1/1;
  background:#fff;
  border-radius:22px;
  display:flex;
  align-items:center;
  justify-content:center;
}
.cell img{
  width:92%;
  height:92%;
  object-fit:contain;
  animation:pop .25s ease;
}
.cell.boom{animation:shake .35s}

/* ===== CONTROLS ===== */
.controls{margin-top:30px}
.bet-title{
  display:flex;
  align-items:center;
  font-size:34px;
  margin-bottom:16px;
}
.bet-row{
  display:flex;
  gap:22px;
}
.bet-row input{
  flex:1;
  padding:42px;
  font-size:46px;
  border-radius:32px;
  border:none;
  text-align:center;
}
.bet-row button{
  padding:42px 48px;
  font-size:44px;
  border-radius:32px;
  border:none;
}

/* SLIDER */
.slider{
  margin:40px auto;
  width:70%;
  text-align:center;
  font-size:36px;
}
input[type=range]{
  -webkit-appearance:none;
  width:100%;
  height:14px;
  border-radius:14px;
  background:#d0d6ff;
}
input[type=range]::-webkit-slider-thumb{
  -webkit-appearance:none;
  width:56px;
  height:56px;
  border-radius:50%;
  background:#4c6fff;
  box-shadow:0 4px 12px rgba(0,0,0,.25);
}

/* BUTTONS */
.play-btn,.cashout-btn{
  width:100%;
  padding:38px;
  font-size:40px;
  border:none;
  border-radius:34px;
  margin-top:26px;
}
.play-btn{background:#4c6fff;color:#fff}
.play-btn:disabled{background:#9aa8ff}
.cashout-btn{background:#22c55e;color:#fff}

/* ANIMATIONS */
@keyframes pop{
  from{transform:scale(.3);opacity:0}
  to{transform:scale(1);opacity:1}
}
@keyframes shake{
  0%{transform:translateX(0)}
  25%{transform:translateX(-6px)}
  50%{transform:translateX(6px)}
  75%{transform:translateX(-6px)}
  100%{transform:translateX(0)}
}
@keyframes boomGlow{
  from{box-shadow:0 0 15px rgba(76,111,255,.4)}
  to{box-shadow:0 0 40px rgba(76,111,255,.7)}
}
</style>
</head>

<body>

<div class="header">
  <div class="avatar"></div>
  <div class="menu-back" id="menuBack" onclick="backToMenu()">Ð² Ð¼ÐµÐ½ÑŽ ðŸŽ°</div>
  <div class="balance" id="balanceBox">
    <img src="coin.png" class="coin-icon">
    <span id="balance">0.00</span>
  </div>
</div>

<div class="menu" id="menu">
  <button class="bomb-btn" onclick="onBoomClick()">
    <img src="boom-icon.png">
    <span>BOOM</span>
  </button>
</div>

<div class="game" id="game">
  <div class="win-info">
    Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð²Ñ‹Ð¸Ð³Ñ€Ñ‹Ñˆ<br>
    <img src="coin.png" class="coin-icon">
    <span id="possibleWin">0.00</span><br>
    x<span id="multiplier">1.00</span>
  </div>

  <div class="grid" id="grid"></div>

  <div class="controls">
    <div class="bet-title">
      <img src="coin.png" class="coin-icon">Ð¡Ñ‚Ð°Ð²ÐºÐ°
    </div>

    <div class="bet-row">
      <button onclick="halfBet()">Â½</button>
      <input type="number" id="bet" value="1" min="1">
      <button onclick="doubleBet()">2Ã—</button>
    </div>

    <div class="slider">
      Ð‘Ð¾Ð¼Ð±: <span id="bombCount">3</span><br>
      <input type="range" min="2" max="10" value="3" oninput="updateBombs(this.value)">
    </div>

    <button class="play-btn" id="playBtn" onclick="play()">Ð˜Ð³Ñ€Ð°Ñ‚ÑŒ</button>
    <button class="cashout-btn" id="cashoutBtn" onclick="cashOut()" style="display:none">
      Ð—Ð°Ð±Ñ€Ð°Ñ‚ÑŒ Ð²Ñ‹Ð¸Ð³Ñ€Ñ‹Ñˆ
    </button>
  </div>
</div>

<script>
const boomSound=new Audio('boom.mp3');
boomSound.volume=0.6;

const explodeSound=new Audio('explode.mp3');
explodeSound.volume=0.8;

/* ===== MULTIPLIER TABLE ===== */
const multiplierTable={
  2:{base:[1.09,1.28,1.33,1.5,1.75,1.9,2.1,2.5,2.8,2.95,3.3,3.6],step:0.35},
  3:{base:[1.14,1.3,1.43,1.73,2.02,2.37,2.82,3.38,4.11,5.05],step:0.8},
  4:{base:[1.19,1.43,1.73,2.11,2.61,3.26,4.13,5.32,6.95,9.27],step:3},
  5:{base:[1.25,1.58,2.02,2.61,3.43,4.61,6.2,8.49,12.16,17.3],step:7},
  6:{base:[1.32,1.75,2.37,3.26,4.57,6.53,9.54,14.31,22.12],step:8},
  7:{base:[1.39,1.96,2.8,4.3,6.2],step:3.3},
  8:{base:[1.47,2.21,3.38,5.32,8.59,14.31,24.72,44.49],step:12},
  9:{base:[1.56,2.5,4.11,6.95,11.16,22.12,42.02,84.04],step:15},
  10:{base:[1.67,2.86,5.05,9.04,17.69,35.38],step:21}
};

let balance=Number(localStorage.getItem('balance'))||1000;
let bombs=[],playing=false,betValue=1;
let openedCount=0;
let multiplier=1;

const balanceEl=document.getElementById('balance');
const balanceBox=document.getElementById('balanceBox');
const grid=document.getElementById('grid');
const multiplierEl=document.getElementById('multiplier');

updateBalance();

function updateBalance(){
  balance=Number(balance.toFixed(2));
  balanceEl.innerText=balance.toFixed(2);
  localStorage.setItem('balance',balance);
}

function onBoomClick(){
  boomSound.currentTime=0;
  boomSound.play();
  openGame();
}

function openGame(){
  menu.style.display='none';
  game.style.display='block';
  menuBack.style.display='block';
  createGrid();
}

function backToMenu(){
  playing=false;
  game.style.display='none';
  menu.style.display='block';
  menuBack.style.display='none';
}

function createGrid(){
  grid.innerHTML='';
  for(let i=0;i<25;i++){
    const c=document.createElement('div');
    c.className='cell';
    c.onclick=()=>openCell(c,i);
    grid.appendChild(c);
  }
}

function updateBombs(v){bombCount.innerText=v}
function halfBet(){bet.value=Math.max(1,Math.floor(bet.value/2))}
function doubleBet(){bet.value=Math.min(balance,bet.value*2)}

function play(){
  if(playing) return;

  betValue=+bet.value;
  if(betValue<1||betValue>balance) return;

  balance-=betValue;
  updateBalance();

  playing=true;
  openedCount=0;
  multiplier=1;
  updateWin();

  playBtn.disabled=true;
  cashoutBtn.style.display='none';

  bombs=[];
  while(bombs.length<Number(bombCount.innerText)){
    let r=Math.floor(Math.random()*25);
    if(!bombs.includes(r)) bombs.push(r);
  }
  createGrid();
}

function openCell(cell,i){
  if(!playing||cell.innerHTML) return;

  openedCount++;

  /* ðŸ”¥ ÐºÐ°Ð¶Ð´Ð¾Ðµ 3-Ðµ Ð¿Ð¾Ð»Ðµ â€” 35% ÑˆÐ°Ð½Ñ ÑÑ‚Ð°Ñ‚ÑŒ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð¼Ð¸Ð½Ð¾Ð¹ */
  if(openedCount%3===0 && !bombs.includes(i)){
    if(Math.random()<0.35){
      bombs.pop();
      bombs.push(i);
    }
  }

  if(bombs.includes(i)){
    explodeSound.currentTime=0;
    explodeSound.play();
    cell.classList.add('boom');
    showBombs();
    playing=false;
    playBtn.disabled=false;
    return;
  }

  const img=document.createElement('img');
  img.src='coin.png';
  cell.appendChild(img);

  updateMultiplier();
  updateWin();
  cashoutBtn.style.display='block';
}

function updateMultiplier(){
  const bombNum=Number(bombCount.innerText);
  const table=multiplierTable[bombNum];
  const step=openedCount-1;

  if(step<table.base.length){
    multiplier=table.base[step];
  }else{
    multiplier=
      table.base[table.base.length-1]+
      table.step*(step-table.base.length+1);
  }
}

function updateWin(){
  multiplierEl.innerText=multiplier.toFixed(2);
  possibleWin.innerText=(betValue*multiplier).toFixed(2);
}

function showBombs(){
  [...grid.children].forEach((c,i)=>{
    if(bombs.includes(i)&&!c.innerHTML){
      const img=document.createElement('img');
      img.src='bomb.png';
      c.appendChild(img);
    }
  });
}

function cashOut(){
  if(!playing) return;
  balance+=betValue*multiplier;
  updateBalance();
  balanceBox.classList.add('win');
  setTimeout(()=>balanceBox.classList.remove('win'),400);
  playing=false;
  playBtn.disabled=false;
  cashoutBtn.style.display='none';
  createGrid();
}
</script>

</body>
</html>